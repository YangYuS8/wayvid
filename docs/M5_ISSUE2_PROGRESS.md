# Issue #2 è¿›å±•æŠ¥å‘Š (Part 1)

**Issue**: #2 - Advanced Multi-Monitor Features  
**æ—¥æœŸ**: 2025-10-24  
**åˆ†æ”¯**: `m5-multi-monitor`  
**çŠ¶æ€**: ğŸš§ è¿›è¡Œä¸­ (23% complete)

---

## âœ… å·²å®ŒæˆåŠŸèƒ½

### 1. è¾“å‡ºåç§°æ¨¡å¼åŒ¹é… (3h)

**å®ç°**:
- æ–°å¢ `src/config/pattern.rs` æ¨¡å—
- æ”¯æŒglobé£æ ¼æ¨¡å¼:
  - `*` - åŒ¹é…ä»»æ„å­—ç¬¦åºåˆ—
  - `?` - åŒ¹é…ä»»æ„å•ä¸ªå­—ç¬¦
  - ç²¾ç¡®åŒ¹é… (æ— é€šé…ç¬¦)

**åŒ¹é…ä¼˜å…ˆçº§**:
1. ç²¾ç¡®åŒ¹é… (æœ€é«˜ä¼˜å…ˆçº§)
2. å…·ä½“æ¨¡å¼ (é€šé…ç¬¦è¶Šå°‘è¶Šä¼˜å…ˆ)
3. é•¿æ¨¡å¼ (ç›¸åŒé€šé…ç¬¦æ•°æ—¶,æ›´é•¿çš„ä¼˜å…ˆ)

**API**:
```rust
use wayvid::config::pattern::{matches_pattern, find_best_match};

// æ£€æŸ¥æ˜¯å¦åŒ¹é…
assert!(matches_pattern("HDMI-A-1", "HDMI-*"));

// æ‰¾åˆ°æœ€ä½³åŒ¹é…
let patterns = vec!["HDMI-*", "HDMI-A-*", "HDMI-A-1"];
let best = find_best_match("HDMI-A-1", &patterns);
assert_eq!(best, Some("HDMI-A-1")); // ç²¾ç¡®åŒ¹é…
```

**é…ç½®ç¤ºä¾‹**:
```yaml
source:
  type: File
  path: "/default.mp4"

per_output:
  # ç²¾ç¡®åŒ¹é…
  "eDP-1":
    layout: Fill
    source:
      type: File
      path: "/laptop-video.mp4"
  
  # HDMIæ˜¾ç¤ºå™¨ä½¿ç”¨æ¨¡å¼åŒ¹é…
  "HDMI-*":
    layout: Contain
    source:
      type: File
      path: "/external-video.mp4"
  
  # DPæ˜¾ç¤ºå™¨
  "DP-?":
    layout: Stretch
```

**æµ‹è¯•è¦†ç›–**:
- 6ä¸ªpatternæ¨¡å—æµ‹è¯•
- 3ä¸ªconfigé›†æˆæµ‹è¯•
- æ‰€æœ‰è¾¹ç•Œæƒ…å†µè¦†ç›–

---

## â³ å¾…å®ç°åŠŸèƒ½

### 2. è¾“å‡ºä¼˜å…ˆçº§/Fallback (3h)

**ç›®æ ‡**: å½“å¤šä¸ªæ¨¡å¼åŒ¹é…æ—¶,æ”¯æŒä¼˜å…ˆçº§æ’åº

**è®¾è®¡**:
```yaml
per_output:
  "HDMI-*":
    priority: 1
    source: ...
  
  "*":
    priority: 99  # æœ€ä½ä¼˜å…ˆçº§ fallback
    source: ...
```

### 3. wayvid-ctl åŠ¨æ€æºåˆ‡æ¢ (3h)

**ç›®æ ‡**: è¿è¡Œæ—¶åˆ‡æ¢è¾“å‡ºæº

**å‘½ä»¤**:
```bash
# åˆ‡æ¢ç‰¹å®šè¾“å‡ºçš„æº
wayvid-ctl set-output-source eDP-1 file:///new-video.mp4

# åˆ‡æ¢æ‰€æœ‰è¾“å‡º
wayvid-ctl set-output-source --all file:///new-video.mp4
```

**IPCåè®®æ‰©å±•**:
```rust
pub enum IpcCommand {
    // ...existing commands...
    SetOutputSource { output: String, source: VideoSource },
}
```

### 4. é…ç½®Schemaæ–‡æ¡£åŒ– (1h)

æ›´æ–°æ–‡æ¡£è¯´æ˜:
- Pattern matchingè¯­æ³•
- ä¼˜å…ˆçº§è§„åˆ™
- ç¤ºä¾‹é…ç½®

### 5. å¤šæ˜¾ç¤ºå™¨æµ‹è¯• (3h)

åœ¨çœŸå®ç¡¬ä»¶ä¸Šæµ‹è¯•:
- 2+ æ˜¾ç¤ºå™¨åœºæ™¯
- çƒ­æ’æ‹”
- æ¨¡å¼åŒ¹é…æ­£ç¡®æ€§
- æ€§èƒ½éªŒè¯

---

## ğŸ“Š è¿›åº¦ç»Ÿè®¡

| ä»»åŠ¡ | é¢„ç®— | å·²ç”¨ | çŠ¶æ€ |
|------|------|------|------|
| Pattern Matching | 3h | 3h | âœ… |
| ä¼˜å…ˆçº§/Fallback | 3h | 0h | â³ |
| wayvid-ctlå‘½ä»¤ | 3h | 0h | â³ |
| Schemaæ–‡æ¡£ | 1h | 0h | â³ |
| å¤šæ˜¾ç¤ºå™¨æµ‹è¯• | 3h | 0h | â³ |
| **æ€»è®¡** | **13h** | **3h** | **23%** |

---

## ğŸ§ª æµ‹è¯•ç»“æœ

**å•å…ƒæµ‹è¯•**: 32/32 é€šè¿‡ âœ…
- Patternæ¨¡å—: 6ä¸ªæµ‹è¯•
- Configé›†æˆ: 3ä¸ªæµ‹è¯•
- å…¶ä»–æ¨¡å—: 23ä¸ªæµ‹è¯•

**Clippy**: æ— è­¦å‘Š âœ…  
**Format**: é€šè¿‡ âœ…

---

## ğŸ“ æŠ€æœ¯ç¬”è®°

### Pattern Matchingç®—æ³•

ä½¿ç”¨é€’å½’å›æº¯ç®—æ³•å®ç°globåŒ¹é…:
- `*` åŒ¹é…é€šè¿‡å°è¯•æ‰€æœ‰å¯èƒ½çš„ä½ç½®
- `?` åŒ¹é…ç²¾ç¡®ä¸€ä¸ªå­—ç¬¦
- ç²¾ç¡®å­—ç¬¦åŒ¹é…

**å¤æ‚åº¦**: O(nÃ—m) å…¶ä¸­ n=nameé•¿åº¦, m=patterné•¿åº¦

### æœ€ä½³åŒ¹é…è¯„åˆ†

```rust
score = if exact_match {
    0  // æœ€é«˜ä¼˜å…ˆçº§
} else {
    wildcards_count Ã— 1000 - pattern_length
}
```

- é€šé…ç¬¦è¶Šå°‘,åˆ†æ•°è¶Šä½(è¶Šä¼˜å…ˆ)
- ç›¸åŒé€šé…ç¬¦æ•°æ—¶,è¶Šé•¿è¶Šä¼˜å…ˆ
- ç²¾ç¡®åŒ¹é…æ€»æ˜¯æœ€ä¼˜

---

## ğŸ”„ ä¸‹ä¸€æ­¥

1. **æ˜å¤©ç»§ç»­**: å®ç°ä¼˜å…ˆçº§/fallbacké€»è¾‘
2. **ç„¶å**: æ·»åŠ wayvid-ctlå‘½ä»¤æ”¯æŒ
3. **æœ€å**: æ–‡æ¡£å’Œå¤šæ˜¾ç¤ºå™¨æµ‹è¯•

**é¢„è®¡å®Œæˆæ—¶é—´**: æ˜å¤©ä¸‹åˆ (è¿˜éœ€10å°æ—¶)

---

## ğŸ¯ æˆåŠŸæ ‡å‡†è¿›åº¦

- [x] æ·»åŠ è¾“å‡ºåç§°æ¨¡å¼åŒ¹é…
- [ ] æ”¯æŒä¸åŒWEé¡¹ç›® per output
- [ ] å®ç°ä¼˜å…ˆçº§/fallback
- [ ] æ·»åŠ  wayvid-ctl set-output-source
- [ ] æ›´æ–°é…ç½®schema
- [ ] å¤šæ˜¾ç¤ºå™¨æµ‹è¯•é€šè¿‡

**å½“å‰**: 1/6 å®Œæˆ

---

**Author**: YangYuS8  
**Branch**: m5-multi-monitor  
**Commit**: 5236d9c
